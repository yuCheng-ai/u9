# 业务流与工作流引擎 (Business Flow & Workflow)

## 概述
在 U9 cloud 体系中，**业务流 (Business Flow)** 与 **工作流 (Workflow)** 是驱动企业高效运行的两大核心引擎。它们共同解决了“业务如何流转”与“决策如何审批”这两个关键问题，实现了从业务触发到最终执行的全链路自动化。

---

## 1. 业务流引擎 (Business Flow)
业务流引擎主要负责处理业务单据之间的**逻辑转换与数据传递**。它定义了企业业务链条中各个节点（单据）的先后顺序及自动驱动规则。

### 核心机制
- **推式 (Push) 与 拉式 (Pull)**:
    - **推式**: 上游单据完成后，根据规则自动生成下游单据（如：采购入库单生成后，自动推送生成应付单）。
    - **拉式**: 下游单据引用上游单据数据生成（如：销售发货单拉取销售订单数据）。
- **规则配置化**: 无需代码开发，通过“单据转换规则”配置字段映射、拆分规则（按供应商、按组织）及合并规则。
- **跨组织驱动**: 支持复杂的集团化场景。例如：A 组织的销售订单自动触发 B 组织的生产订单或 C 组织的调拨指令。
- **单据状态机**: 严格控制单据生命周期。只有当业务流中的前置条件满足时（如：必须先质检合格），下游单据才能被触发。

### 业务价值
- **消除信息孤岛**: 确保上下游数据百分百一致，减少人工录入错误。
- **流程标准化**: 将企业最佳实践固化到系统中，确保所有业务按既定路径流转。

---

## 2. 工作流引擎 (Workflow)
工作流引擎（又称审批流）负责处理业务过程中的**合规性控制与决策审批**。它通过可视化设计器，将复杂的管理制度转化为自动化的审批路径。

### 核心功能
- **可视化设计器 (Visual Designer)**: 拖拽式配置流程节点（审批节点、抄送节点、条件分支、子流程）。
- **灵活的审批策略**:
    - **或签/会签**: 支持一人通过即生效或全员通过才生效。
    - **动态分支**: 根据单据金额、物料类别、所属部门等字段值，自动走向不同的审批层级。
    - **角色化审批**: 支持按岗位、角色、特定人员或组织汇报关系动态寻找审批人。
- **弹性流程处理**:
    - **驳回/重置**: 支持驳回至发起人或任意历史节点。
    - **代理/改派**: 审批人出差时，可设置代理人处理或由管理员手动改派。
    - **加签**: 在当前审批环节临时增加其他协办人。

### 移动化与集成
- **全端协同**: 支持 PC 端、移动端（友空间/钉钉/企业微信）同步审批，确保决策不延误。
- **预警通知**: 流程超时自动提醒，支持邮件、短信、系统消息等多渠道触达。

---

## 3. 业务流与工作流的深度协同
在实际运行中，两者紧密配合：
1. **触发**: 业务人员提交单据。
2. **校验 (工作流)**: 工作流引擎介入，根据金额等规则进行层级审批。
3. **驱动 (业务流)**: 审批终审通过后，业务流引擎自动触发，生成下游单据或更新相关库存/财务数据。
4. **闭环**: 下游业务执行结果反馈至上游，完成整个业务闭环。

---

## 4. 落地建议 (PM Insights)
- **从宽到严**: 实施初期建议先固化核心业务流，审批流可以先简化，避免因流程过细导致业务停滞。
- **关注异常流**: 除了定义“标准路径”，更要设计好驳回、撤回、作废等异常路径，提升系统容错性。
- **数据驱动监控**: 利用“流程时效分析”报表，识别企业运营中的瓶颈环节（如：哪个部门审批最慢），为流程优化提供依据。
